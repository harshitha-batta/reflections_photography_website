<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reflections</title>
  
  <!-- External Stylesheets -->
  <link rel="stylesheet" href="/navbar.css">
  <link rel="stylesheet" href="/gallery.css">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montez&family=Pacifico&family=Lora:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
</head>
<body>
  
  <!-- Navbar -->
  <%- include('layouts/main') %>

  <!-- Main Content -->
  <main>
    <!-- Hero Section -->
    <section class="hero">
      <h1>Discover the Beauty of Reflections</h1>
      <div class="hero-dropdown">
        <select class="explore-dropdown" id="explore-dropdown" name="explore-dropdown">
          <option value="" disabled selected>Explore</option>
          <% categories.forEach(category => { %>
            <option value="<%= category._id %>"><%= category.name %></option>
          <% }) %>
        </select>
        <label for="explore-dropdown">Breathtaking photos and unleash your creativity.</label>
      </div>
    </section>

    <!-- Categories Section -->
    <section class="categories">
      <h2>Featured Collections</h2>
      <div class="category-container">
        <!-- Scroll Buttons -->
        <button class="scroll-left" aria-label="Scroll Left">&larr;</button>
        
        <!-- Category Buttons -->
        <div class="category-buttons">
          <% categories.forEach(category => { %>
            <button onclick="window.location.href='/category/<%= category._id %>'">
              <%= category.name %>
            </button>
          <% }) %>
        </div>
        
        <button class="scroll-right" aria-label="Scroll Right">&rarr;</button>
      </div>
    </section>

    <!-- Dynamic Featured Collections Section -->
    <section class="featured">
      <div class="gallery">
        <% photos.forEach(photo => { %>
          <div class="gallery-item">
            <a href="/readerPost/<%= photo._id %>">
              <img 
                src="<%= photo.imagePath.startsWith('http') ? photo.imagePath : '/profile/photo/' + encodeURIComponent(photo.imagePath) %>" 
                alt="<%= photo.category %>"
              >
            </a>
          </div>
        <% }) %>
      </div>
    </section>
  </main>

  <!-- JavaScript -->
  <script>
    // Scroll Functionality for Categories Section
    const categoryContainer = document.querySelector('.category-buttons');
    const scrollLeftButton = document.querySelector('.scroll-left');
    const scrollRightButton = document.querySelector('.scroll-right');

    function updateScrollButtons() {
      const scrollLeft = categoryContainer.scrollLeft;
      const scrollWidth = categoryContainer.scrollWidth;
      const clientWidth = categoryContainer.clientWidth;

      scrollLeftButton.style.display = scrollLeft > 0 ? 'block' : 'none';
      scrollRightButton.style.display = scrollLeft + clientWidth < scrollWidth ? 'block' : 'none';
    }

    categoryContainer.addEventListener('scroll', updateScrollButtons);
    window.addEventListener('resize', updateScrollButtons);

    updateScrollButtons();

    scrollLeftButton.addEventListener('click', () => {
      categoryContainer.scrollBy({ left: -200, behavior: 'smooth' });
    });

    scrollRightButton.addEventListener('click', () => {
      categoryContainer.scrollBy({ left: 200, behavior: 'smooth' });
    });

    // Dropdown Navigation
    const dropdown = document.getElementById('explore-dropdown');
    dropdown.addEventListener('change', (event) => {
      const selectedValue = event.target.value;
      if (selectedValue) {
        window.location.href = /category/${selectedValue};
      }
    });
  </script>
</body>
</html>